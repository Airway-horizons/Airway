import{e as Y,r as x,p as A,j as e,B as k,I as v,al as N,T as S,S as b,am as $,a6 as K,a5 as Q,an as J,ao as X,l as U,ap as q,aq as Z,ar as ee,P as se,as as te,C as ne,at as re,V as oe}from"./index-vitjOLJc.js";import{S as ae,o as E}from"./search-not-found-_NgLi5Ax.js";import{u as ie}from"./use-boolean-CllosG7m.js";import{f as C,i as le,a as ce}from"./format-time-DF4OtWkl.js";import{c as H,a as de,T as pe}from"./_calendar-M2pCLfOc.js";import{E as me}from"./empty-content-nlbqSvWK.js";import{C as ue}from"./custom-breadcrumbs-CTgE64aS.js";import{T as he,a as xe}from"./helper-Ba-6b4Y6.js";import{C as je}from"./custom-popover-C8U1xbb4.js";import{u as fe}from"./use-popover-B_OAFYl8.js";import{B as W}from"./Button-uH7OjBnn.js";import{M as ge}from"./MenuItem-D7s2rOai.js";import{m as be,p as ve}from"./index-BeJnmHxJ.js";import{A as G}from"./Autocomplete-BfcwL55-.js";import{T as D}from"./TextField-BcfiYXFL.js";import{I as _}from"./InputAdornment-9ipI_hcs.js";import{A as M}from"./Avatar-CNKE7_yW.js";import{C as w}from"./Chip-BKsvXYEg.js";import{D as z}from"./tour-details-content-Bhv-rFWO.js";import{F as ye,C as Ce}from"./Checkbox-DjDClGej.js";import{t as V}from"./helper-BsRYrhP4.js";import"./_baseIteratee-DZJGvniY.js";import"./createSvgIcon-Cf14EvpH.js";import"./format-number-gsHnOWGY.js";import"./image-0YEpbRpF.js";import"./styles-2QjQ7EfR.js";import"./Card-9HnBcqE0.js";import"./ListItemText-D5ZMAt5k.js";import"./Close-VPdmPgPL.js";import"./useFormControl-DF-2wNsX.js";import"./formControlState-Dq1zat_P.js";import"./useSlot-CsnqWRu2.js";import"./index-fWgd3WxR.js";import"./transition-BJzcwH5q.js";import"./use-light-box-u0kLnIRR.js";import"./yup-6wmwP2ql.js";import"./index.esm-DsxKZZhs.js";import"./index-DfBlkqaH.js";import"./DialogTitle-Cnb-gZ_d.js";import"./ListItem-BHNYhHgB.js";import"./SwitchBase-CNbGrViv.js";function Se({tours:s}){const r=Y(),d=x.useCallback(n=>{r.push(A.packageDetails(n))},[r]);return e.jsx(e.Fragment,{children:e.jsx(k,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},sx:{mb:8},children:s==null?void 0:s.map(n=>e.jsx(he,{tour:n,onView:()=>d(n.id)},n.id))})})}function we({sort:s,onSort:r,sortOptions:d}){const n=fe();return e.jsxs(e.Fragment,{children:[e.jsxs(W,{disableRipple:!0,color:"inherit",onClick:n.onOpen,endIcon:e.jsx(v,{icon:n.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort By:",e.jsx(k,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),e.jsx(je,{open:n.open,onClose:n.onClose,sx:{width:140},children:d.map(a=>e.jsx(ge,{selected:a.value===s,onClick:()=>{n.onClose(),r(a.value)},children:a.label},a.value))})]})}function ke({query:s,results:r,onSearch:d,hrefItem:n}){const a=Y(),h=o=>{console.log(o),a.push(A.packageDetails(o))},m=o=>{if(s&&o.key==="Enter"){const t=r.filter(l=>l.name===s)[0];h(t.id)}};return e.jsx(G,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:r,onInputChange:(o,t)=>d(t),getOptionLabel:o=>o.name,noOptionsText:e.jsx(ae,{query:s,sx:{bgcolor:"unset"}}),isOptionEqualToValue:(o,t)=>o.id===t.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${N.option}`]:{pl:.75}}}},renderInput:o=>e.jsx(D,{...o,placeholder:"Search...",onKeyUp:m,InputProps:{...o.InputProps,startAdornment:e.jsx(_,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(o,t,{inputValue:l})=>{const p=be(t.name,l),i=ve(t.name,p);return x.createElement(k,{component:"li",...o,onClick:()=>h(t.id),key:t.id},e.jsx(M,{alt:t.name,src:t.images[0],variant:"rounded",sx:{width:48,height:48,flexShrink:0,mr:1.5,borderRadius:1}},t.id),e.jsx("div",{children:i.map((j,g)=>e.jsx(S,{component:"span",color:j.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:j.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:j.text},g))},l))}})}function Te({label:s,error:r,helperText:d,placeholder:n,...a}){const h=a==null?void 0:a.multiple;return e.jsx(G,{autoHighlight:!h,disableCloseOnSelect:h,renderOption:(m,o)=>{var l;const t=B(o);return t.label?x.createElement("li",{...m,key:t.label},e.jsx(v,{icon:`circle-flags:${(l=t.code)==null?void 0:l.toLowerCase()}`,sx:{mr:1}},t.label),t.label," (",t.code,") +",t.phone):null},renderInput:m=>{var l;const o=B(m.inputProps.value),t={...m,label:s,placeholder:n,error:!!r,helperText:d,inputProps:{...m.inputProps,autoComplete:"new-password"}};return h?e.jsx(D,{...t}):e.jsx(D,{...t,InputProps:{...m.InputProps,startAdornment:e.jsx(_,{position:"start",sx:{...!o.code&&{display:"none"}},children:e.jsx(v,{icon:`circle-flags:${(l=o.code)==null?void 0:l.toLowerCase()}`,sx:{mr:-.5,ml:.5}})})}})},renderTags:(m,o)=>m.map((t,l)=>{var i;const p=B(t);return x.createElement(w,{...o({index:l}),key:p.label,label:p.label,icon:e.jsx(v,{icon:`circle-flags:${(i=p.code)==null?void 0:i.toLowerCase()}`}),size:"small",variant:"soft"})}),...a})}function B(s){return{...H.filter(d=>d.label===s)[0]}}function Ie({open:s,onOpen:r,onClose:d,filters:n,onFilters:a,canReset:h,onResetFilters:m,destinationOptions:o,tourGuideOptions:t,serviceOptions:l,dateError:p}){const i=x.useCallback(c=>{const f=n.services.includes(c)?n.services.filter(u=>u!==c):[...n.services,c];a("services",f)},[n.services,a]),j=x.useCallback(c=>{a("startDate",c)},[a]),g=x.useCallback(c=>{a("endDate",c)},[a]),F=x.useCallback(c=>{a("destination",c)},[a]),I=x.useCallback(c=>{a("tourGuides",c)},[a]),P=e.jsxs(b,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(S,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(X,{title:"Reset",children:e.jsx(U,{onClick:m,children:e.jsx($,{color:"error",variant:"dot",invisible:!h,children:e.jsx(v,{icon:"solar:restart-bold"})})})}),e.jsx(U,{onClick:d,children:e.jsx(v,{icon:"mingcute:close-line"})})]});b,S,b,z,n.startDate,z,n.endDate;const R=e.jsxs(b,{children:[e.jsx(S,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Te,{placeholder:n.destination.length?"+ Destination":"Select Destination",fullWidth:!0,multiple:!0,value:n.destination,onChange:(c,f)=>F(f),options:o,getOptionLabel:c=>c})]});b,S,G,n.tourGuides;const L=e.jsxs(b,{children:[e.jsx(S,{variant:"subtitle2",sx:{mb:1},children:"Services"}),l.map(c=>e.jsx(ye,{control:e.jsx(Ce,{checked:n.services.includes(c),onClick:()=>i(c)}),label:c},c))]});return e.jsxs(e.Fragment,{children:[e.jsx(W,{disableRipple:!0,color:"inherit",endIcon:e.jsx($,{color:"error",variant:"dot",invisible:!h,children:e.jsx(v,{icon:"ic:round-filter-list"})}),onClick:r,children:"Filters"}),e.jsxs(K,{anchor:"right",open:s,onClose:d,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:[P,e.jsx(Q,{}),e.jsx(J,{sx:{px:2.5,py:3},children:e.jsxs(b,{spacing:3,children:[R,L]})})]})]})}function Pe(s,r){const d=new Date().getFullYear(),n=s?q(s):null,a=r?q(r):null,h=d===n&&d===a,m=s&&r?Z(new Date(s),new Date(r)):!1,o=s&&r?ee(new Date(s),new Date(r)):!1;return h?o?m?C(r,"dd MMM yy"):`${C(s,"dd")} - ${C(r,"dd MMM yy")}`:`${C(s,"dd MMM")} - ${C(r,"dd MMM yy")}`:`${C(s,"dd MMM yy")} - ${C(r,"dd MMM yy")}`}function Oe({filters:s,onFilters:r,canReset:d,onResetFilters:n,results:a,...h}){const m=Pe(s.startDate,s.endDate),o=i=>{const j=s.services.filter(g=>g!==i);r("services",j)},t=()=>{r("startDate",null),r("endDate",null)},l=i=>{const j=s.tourGuides.filter(g=>g.name!==i.name);r("tourGuides",j)},p=i=>{const j=s.destination.filter(g=>g!==i);r("destination",j)};return e.jsxs(b,{spacing:1.5,...h,children:[e.jsxs(k,{sx:{typography:"body2"},children:[e.jsx("strong",{children:a}),e.jsx(k,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(b,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[s.startDate&&s.endDate&&e.jsx(O,{label:"Available:",children:e.jsx(w,{size:"small",label:m,onDelete:t})}),!!s.services.length&&e.jsx(O,{label:"Services:",children:s.services.map(i=>e.jsx(w,{label:i,size:"small",onDelete:()=>o(i)},i))}),!!s.tourGuides.length&&e.jsx(O,{label:"Tour guide:",children:s.tourGuides.map(i=>e.jsx(w,{size:"small",avatar:e.jsx(M,{alt:i.name,src:i.avatarUrl}),label:i.name,onDelete:()=>l(i)},i.id))}),!!s.destination.length&&e.jsx(O,{label:"Destination:",children:s.destination.map(i=>e.jsx(w,{label:i,size:"small",onDelete:()=>p(i)},i))}),d&&e.jsx(W,{color:"error",onClick:n,startIcon:e.jsx(v,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function O({label:s,children:r,sx:d,...n}){return e.jsxs(b,{component:se,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...d},...n,children:[e.jsx(k,{component:"span",sx:{typography:"subtitle2"},children:s}),e.jsx(b,{spacing:1,direction:"row",flexWrap:"wrap",children:r})]})}const De=()=>new URLSearchParams(re().search);function Me(){const s=te(),d=De().get("id"),n={destination:[],tourGuides:[],services:[],startDate:null,endDate:null},a=ie(),[h,m]=x.useState("latest"),[o,t]=x.useState({query:"",results:[]}),[l,p]=x.useState(n),i=le(l.startDate,l.endDate),j=Fe({inputData:V,filters:l,sortBy:h,dateError:i}),g=!!l.destination.length||!!l.tourGuides.length||!!l.services.length||!!l.startDate&&!!l.endDate,F=!j.length&&g,I=x.useCallback((u,y)=>{p(T=>({...T,[u]:y}))},[]);x.useEffect(()=>{d&&p(u=>({...u,destination:[d]}))},[d]);const P=x.useCallback(()=>{p(n)},[]),R=x.useCallback(u=>{m(u)},[]),L=x.useCallback(u=>{if(t(y=>({...y,query:u})),u){const y=V.filter(T=>T.name.toLowerCase().indexOf(o.query.toLowerCase())!==-1);t(T=>({...T,results:y}))}},[o.query]),c=e.jsxs(b,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(ke,{query:o.query,results:o.results,onSearch:L,hrefItem:u=>A.dashboard.tour.details(u)}),e.jsxs(b,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Ie,{open:a.value,onOpen:a.onTrue,onClose:a.onFalse,filters:l,onFilters:I,canReset:g,onResetFilters:P,serviceOptions:xe.map(u=>u.label),tourGuideOptions:de,destinationOptions:H.map(u=>u.label),dateError:i}),e.jsx(we,{sort:h,onSort:R,sortOptions:pe})]})]}),f=e.jsx(Oe,{filters:l,onResetFilters:P,canReset:g,onFilters:I,results:j.length});return e.jsxs(ne,{maxWidth:s.themeStretch?!1:"lg",children:[e.jsx(ue,{heading:"Packages List",sx:{mb:{xs:3,md:5}}}),e.jsxs(b,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[c,g&&f]}),F&&e.jsx(me,{title:"No Data",filled:!0,sx:{py:10}}),e.jsx(Se,{tours:j})]})}const Fe=({inputData:s,filters:r,sortBy:d,dateError:n})=>{const{services:a,destination:h,startDate:m,endDate:o,tourGuides:t}=r,l=t==null?void 0:t.map(p=>p.id);return d==="latest"&&(s=E(s,["createdAt"],["desc"])),d==="oldest"&&(s=E(s,["createdAt"],["asc"])),d==="popular"&&(s=E(s,["totalViews"],["desc"])),h.length&&(s=s.filter(p=>h.includes(p.destination))),l.length&&(s=s.filter(p=>p.tourGuides.some(i=>l.includes(i.id)))),a.length&&(s=s.filter(p=>p.services.some(i=>a.includes(i)))),n||m&&o&&(s=s.filter(p=>ce(m,p.available.startDate,p.available.endDate))),s};function vs(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:"Airway Horizons: Package List"})}),e.jsx(Me,{})]})}export{vs as default};
