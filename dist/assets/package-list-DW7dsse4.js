import{e as H,r as x,p as A,j as e,B as k,I as v,aj as N,T as S,S as b,ak as U,a5 as K,a4 as Q,al as J,am as X,l as $,an as q,ao as Z,ap as ee,P as se,aq as te,C as ne,ar as re,U as oe}from"./index-BhdCYkZV.js";import{S as ae,o as E}from"./search-not-found-DMrYv-sT.js";import{u as ie}from"./use-boolean-C94Jhiw3.js";import{f as C,i as le,a as ce}from"./format-time-5eis5PTK.js";import{c as V,b as de,T as pe}from"./_calendar-Dyx2_jOo.js";import{E as ue}from"./empty-content-DR8v68t7.js";import{C as me}from"./custom-breadcrumbs-BeiNubHp.js";import{T as he}from"./tour-item-CfSxu6X9.js";import{C as xe}from"./custom-popover-DFZVa3lV.js";import{u as je}from"./use-popover-CQG8HHeb.js";import{B as W}from"./Button-DZJrFnGY.js";import{M as fe}from"./MenuItem-Dj2whVcC.js";import{m as ge,p as be}from"./styles-DRY8vysJ.js";import{A as G}from"./Autocomplete-p0Ap7KKL.js";import{T as D}from"./TextField-CncyZTD-.js";import{I as _}from"./InputAdornment-C-W3VgYD.js";import{A as M}from"./Avatar-BHKZIHTj.js";import{C as w}from"./Chip-bQaCAoIM.js";import{D as z}from"./book-form-DfQkEKSD.js";import{F as ve,C as ye}from"./Checkbox-1hf6bwx3.js";import{t as Y,T as Ce}from"./helper-7KL5HGAd.js";import"./styles-RB4_yDgs.js";import"./image-BJJE_TPR.js";import"./index.esm-D-Soo4Ud.js";import"./_baseIteratee-DAAn3-s3.js";import"./createSvgIcon-BFEWvRmZ.js";import"./format-number-CumFFTXv.js";import"./Card-BFYwemZH.js";import"./ListItemText-C0K72W-6.js";import"./Close-CIB2ylP8.js";import"./useFormControl-Bfj9sF6o.js";import"./formControlState-Dq1zat_P.js";import"./useSlot-D6O1eN6S.js";import"./yup-BTbT6D2D.js";import"./DialogContent-CifZie3f.js";import"./ListItem-2igeuWLJ.js";import"./SwitchBase-CPi4W2Vl.js";function Se({tours:s}){const r=H(),d=x.useCallback(n=>{r.push(A.packageDetails(n))},[r]);return e.jsx(e.Fragment,{children:e.jsx(k,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},sx:{mb:8},children:s==null?void 0:s.map(n=>e.jsx(he,{tour:n,onView:()=>d(n.id)},n.id))})})}function we({sort:s,onSort:r,sortOptions:d}){const n=je();return e.jsxs(e.Fragment,{children:[e.jsxs(W,{disableRipple:!0,color:"inherit",onClick:n.onOpen,endIcon:e.jsx(v,{icon:n.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort By:",e.jsx(k,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),e.jsx(xe,{open:n.open,onClose:n.onClose,sx:{width:140},children:d.map(a=>e.jsx(fe,{selected:a.value===s,onClick:()=>{n.onClose(),r(a.value)},children:a.label},a.value))})]})}function ke({query:s,results:r,onSearch:d,hrefItem:n}){const a=H(),h=o=>{console.log(o),a.push(A.packageDetails(o))},u=o=>{if(s&&o.key==="Enter"){const t=r.filter(l=>l.name===s)[0];h(t.id)}};return e.jsx(G,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:r,onInputChange:(o,t)=>d(t),getOptionLabel:o=>o.name,noOptionsText:e.jsx(ae,{query:s,sx:{bgcolor:"unset"}}),isOptionEqualToValue:(o,t)=>o.id===t.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${N.option}`]:{pl:.75}}}},renderInput:o=>e.jsx(D,{...o,placeholder:"Search...",onKeyUp:u,InputProps:{...o.InputProps,startAdornment:e.jsx(_,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(o,t,{inputValue:l})=>{const p=ge(t.name,l),i=be(t.name,p);return x.createElement(k,{component:"li",...o,onClick:()=>h(t.id),key:t.id},e.jsx(M,{alt:t.name,src:t.images[0],variant:"rounded",sx:{width:48,height:48,flexShrink:0,mr:1.5,borderRadius:1}},t.id),e.jsx("div",{children:i.map((j,g)=>e.jsx(S,{component:"span",color:j.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:j.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:j.text},g))},l))}})}function Te({label:s,error:r,helperText:d,placeholder:n,...a}){const h=a==null?void 0:a.multiple;return e.jsx(G,{autoHighlight:!h,disableCloseOnSelect:h,renderOption:(u,o)=>{var l;const t=B(o);return t.label?x.createElement("li",{...u,key:t.label},e.jsx(v,{icon:`circle-flags:${(l=t.code)==null?void 0:l.toLowerCase()}`,sx:{mr:1}},t.label),t.label," (",t.code,") +",t.phone):null},renderInput:u=>{var l;const o=B(u.inputProps.value),t={...u,label:s,placeholder:n,error:!!r,helperText:d,inputProps:{...u.inputProps,autoComplete:"new-password"}};return h?e.jsx(D,{...t}):e.jsx(D,{...t,InputProps:{...u.InputProps,startAdornment:e.jsx(_,{position:"start",sx:{...!o.code&&{display:"none"}},children:e.jsx(v,{icon:`circle-flags:${(l=o.code)==null?void 0:l.toLowerCase()}`,sx:{mr:-.5,ml:.5}})})}})},renderTags:(u,o)=>u.map((t,l)=>{var i;const p=B(t);return x.createElement(w,{...o({index:l}),key:p.label,label:p.label,icon:e.jsx(v,{icon:`circle-flags:${(i=p.code)==null?void 0:i.toLowerCase()}`}),size:"small",variant:"soft"})}),...a})}function B(s){return{...V.filter(d=>d.label===s)[0]}}function Ie({open:s,onOpen:r,onClose:d,filters:n,onFilters:a,canReset:h,onResetFilters:u,destinationOptions:o,tourGuideOptions:t,serviceOptions:l,dateError:p}){const i=x.useCallback(c=>{const f=n.services.includes(c)?n.services.filter(m=>m!==c):[...n.services,c];a("services",f)},[n.services,a]),j=x.useCallback(c=>{a("startDate",c)},[a]),g=x.useCallback(c=>{a("endDate",c)},[a]),F=x.useCallback(c=>{a("destination",c)},[a]),I=x.useCallback(c=>{a("tourGuides",c)},[a]),P=e.jsxs(b,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(S,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(X,{title:"Reset",children:e.jsx($,{onClick:u,children:e.jsx(U,{color:"error",variant:"dot",invisible:!h,children:e.jsx(v,{icon:"solar:restart-bold"})})})}),e.jsx($,{onClick:d,children:e.jsx(v,{icon:"mingcute:close-line"})})]});b,S,b,z,n.startDate,z,n.endDate;const R=e.jsxs(b,{children:[e.jsx(S,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Te,{placeholder:n.destination.length?"+ Destination":"Select Destination",fullWidth:!0,multiple:!0,value:n.destination,onChange:(c,f)=>F(f),options:o,getOptionLabel:c=>c})]});b,S,G,n.tourGuides;const L=e.jsxs(b,{children:[e.jsx(S,{variant:"subtitle2",sx:{mb:1},children:"Services"}),l.map(c=>e.jsx(ve,{control:e.jsx(ye,{checked:n.services.includes(c),onClick:()=>i(c)}),label:c},c))]});return e.jsxs(e.Fragment,{children:[e.jsx(W,{disableRipple:!0,color:"inherit",endIcon:e.jsx(U,{color:"error",variant:"dot",invisible:!h,children:e.jsx(v,{icon:"ic:round-filter-list"})}),onClick:r,children:"Filters"}),e.jsxs(K,{anchor:"right",open:s,onClose:d,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:[P,e.jsx(Q,{}),e.jsx(J,{sx:{px:2.5,py:3},children:e.jsxs(b,{spacing:3,children:[R,L]})})]})]})}function Pe(s,r){const d=new Date().getFullYear(),n=s?q(s):null,a=r?q(r):null,h=d===n&&d===a,u=s&&r?Z(new Date(s),new Date(r)):!1,o=s&&r?ee(new Date(s),new Date(r)):!1;return h?o?u?C(r,"dd MMM yy"):`${C(s,"dd")} - ${C(r,"dd MMM yy")}`:`${C(s,"dd MMM")} - ${C(r,"dd MMM yy")}`:`${C(s,"dd MMM yy")} - ${C(r,"dd MMM yy")}`}function Oe({filters:s,onFilters:r,canReset:d,onResetFilters:n,results:a,...h}){const u=Pe(s.startDate,s.endDate),o=i=>{const j=s.services.filter(g=>g!==i);r("services",j)},t=()=>{r("startDate",null),r("endDate",null)},l=i=>{const j=s.tourGuides.filter(g=>g.name!==i.name);r("tourGuides",j)},p=i=>{const j=s.destination.filter(g=>g!==i);r("destination",j)};return e.jsxs(b,{spacing:1.5,...h,children:[e.jsxs(k,{sx:{typography:"body2"},children:[e.jsx("strong",{children:a}),e.jsx(k,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(b,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[s.startDate&&s.endDate&&e.jsx(O,{label:"Available:",children:e.jsx(w,{size:"small",label:u,onDelete:t})}),!!s.services.length&&e.jsx(O,{label:"Services:",children:s.services.map(i=>e.jsx(w,{label:i,size:"small",onDelete:()=>o(i)},i))}),!!s.tourGuides.length&&e.jsx(O,{label:"Tour guide:",children:s.tourGuides.map(i=>e.jsx(w,{size:"small",avatar:e.jsx(M,{alt:i.name,src:i.avatarUrl}),label:i.name,onDelete:()=>l(i)},i.id))}),!!s.destination.length&&e.jsx(O,{label:"Destination:",children:s.destination.map(i=>e.jsx(w,{label:i,size:"small",onDelete:()=>p(i)},i))}),d&&e.jsx(W,{color:"error",onClick:n,startIcon:e.jsx(v,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function O({label:s,children:r,sx:d,...n}){return e.jsxs(b,{component:se,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...d},...n,children:[e.jsx(k,{component:"span",sx:{typography:"subtitle2"},children:s}),e.jsx(b,{spacing:1,direction:"row",flexWrap:"wrap",children:r})]})}const De=()=>new URLSearchParams(re().search);function Me(){const s=te(),d=De().get("id"),n={destination:[],tourGuides:[],services:[],startDate:null,endDate:null},a=ie(),[h,u]=x.useState("latest"),[o,t]=x.useState({query:"",results:[]}),[l,p]=x.useState(n),i=le(l.startDate,l.endDate),j=Fe({inputData:Y,filters:l,sortBy:h,dateError:i}),g=!!l.destination.length||!!l.tourGuides.length||!!l.services.length||!!l.startDate&&!!l.endDate,F=!j.length&&g,I=x.useCallback((m,y)=>{p(T=>({...T,[m]:y}))},[]);x.useEffect(()=>{d&&p(m=>({...m,destination:[d]}))},[d]);const P=x.useCallback(()=>{p(n)},[]),R=x.useCallback(m=>{u(m)},[]),L=x.useCallback(m=>{if(t(y=>({...y,query:m})),m){const y=Y.filter(T=>T.name.toLowerCase().indexOf(o.query.toLowerCase())!==-1);t(T=>({...T,results:y}))}},[o.query]),c=e.jsxs(b,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(ke,{query:o.query,results:o.results,onSearch:L,hrefItem:m=>A.dashboard.tour.details(m)}),e.jsxs(b,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Ie,{open:a.value,onOpen:a.onTrue,onClose:a.onFalse,filters:l,onFilters:I,canReset:g,onResetFilters:P,serviceOptions:Ce.map(m=>m.label),tourGuideOptions:de,destinationOptions:V.map(m=>m.label),dateError:i}),e.jsx(we,{sort:h,onSort:R,sortOptions:pe})]})]}),f=e.jsx(Oe,{filters:l,onResetFilters:P,canReset:g,onFilters:I,results:j.length});return e.jsxs(ne,{maxWidth:s.themeStretch?!1:"lg",children:[e.jsx(me,{heading:"Packages List",sx:{mb:{xs:3,md:5}}}),e.jsxs(b,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[c,g&&f]}),F&&e.jsx(ue,{title:"No Data",filled:!0,sx:{py:10}}),e.jsx(Se,{tours:j})]})}const Fe=({inputData:s,filters:r,sortBy:d,dateError:n})=>{const{services:a,destination:h,startDate:u,endDate:o,tourGuides:t}=r,l=t==null?void 0:t.map(p=>p.id);return d==="latest"&&(s=E(s,["createdAt"],["desc"])),d==="oldest"&&(s=E(s,["createdAt"],["asc"])),d==="popular"&&(s=E(s,["totalViews"],["desc"])),h.length&&(s=s.filter(p=>h.includes(p.destination))),l.length&&(s=s.filter(p=>p.tourGuides.some(i=>l.includes(i.id)))),a.length&&(s=s.filter(p=>p.services.some(i=>a.includes(i)))),n||u&&o&&(s=s.filter(p=>ce(u,p.available.startDate,p.available.endDate))),s};function js(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:"Airway Horizons: Package List"})}),e.jsx(Me,{})]})}export{js as default};
