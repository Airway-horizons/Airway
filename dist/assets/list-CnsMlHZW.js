import{h as _,j as e,S as x,f as k,i as Y,k as Z,L as ee,R as H,p as w,d as W,e as g,C as se,l as $,M as E,a as K,r as m,B,bo as te,bp as re,I as ne,bq as oe,br as ae,F as L,T,bs as z,be as ie,D as le,bt as ce,bu as de,A as pe,bv as he,c as xe,bw as me,K as U,bx as ue,by as be,bz as je,bA as ge,v as fe,bB as ve,H as Ce}from"./index-DQumLT9L.js";import{o as G}from"./orderBy-BAiUPrXu.js";import{E as ye}from"./empty-content-C-k1mDHV.js";import{C as we}from"./custom-breadcrumbs-BQV5gBXp.js";import{f as q}from"./format-number-DbkgK7Ht.js";import{I as A}from"./image-BQLAgES7.js";import{s as M}from"./utils-DrUvN8WH.js";import{P as ke,p as Se}from"./Pagination-DZ57WmWJ.js";import{A as J}from"./Autocomplete-CrAcmVXV.js";import{T as Q}from"./TextField-Y2PbW22P.js";import{C as Te}from"./country-select-C-PafnHM.js";import{D as N}from"./DatePicker-CqbniZ6K.js";import{C as P}from"./Chip-BV5fqBH-.js";import{F as De}from"./FormControlLabel-DtJZHq2N.js";import{C as Ie}from"./Checkbox-Sn2x42hf.js";import"./mui-one-time-password-input.es-CrCnoD2A.js";import"./highlight-DjC4x1cy.js";import"./styles-CbjE8cRF.js";import"./styles-CZezhFX0.js";import"./_baseToString-DDDuf8FE.js";import"./_baseIteratee-vYTpPPPm.js";import"./_baseEach-Bte6FWsO.js";import"./FirstPage-BHRCtckg.js";import"./Select-DVR-Fv5D.js";import"./Menu-DSL53x_F.js";import"./Close-88YqgUWU.js";import"./FormControl-CkY9ZgKl.js";import"./FormLabel-DQT9OHMa.js";import"./index-SXeguD1C.js";import"./DialogActions-BM5MBnWR.js";import"./ListItem-CasPjPth.js";import"./ListItemSecondaryAction-C30uJhZz.js";import"./DialogContent-BWFRvN7V.js";import"./dialogTitleClasses-DoSL4AIa.js";import"./SwitchBase-C1d58dFN.js";function Re({tour:s,onView:i,onEdit:p,onDelete:o}){const r=_(),{id:l,name:h,price:c,images:a,bookers:u,createdAt:d,available:n,priceSale:b,destination:f,ratingNumber:D}=s,I=M(n.startDate,n.endDate),R=e.jsxs(x,{direction:"row",alignItems:"center",sx:{top:8,right:8,zIndex:9,borderRadius:1,position:"absolute",p:"2px 6px 2px 4px",typography:"subtitle2",bgcolor:"warning.lighter"},children:[e.jsx(g,{icon:"eva:star-fill",sx:{color:"warning.main",mr:.25}})," ",D]}),O=e.jsxs(x,{direction:"row",alignItems:"center",sx:{top:8,left:8,zIndex:9,borderRadius:1,bgcolor:"grey.800",position:"absolute",p:"2px 6px 2px 4px",color:"common.white",typography:"subtitle2"},children:[!!b&&e.jsx(k,{component:"span",sx:{color:"grey.500",mr:.25,textDecoration:"line-through"},children:q(b)}),q(c)]}),j=e.jsxs(x,{spacing:.5,direction:"row",sx:{p:t=>t.spacing(1,1,0,1)},children:[e.jsxs(x,{flexGrow:1,sx:{position:"relative"},children:[O,R,e.jsx(A,{alt:a[0],src:a[0],sx:{borderRadius:1,height:164,width:1}})]}),e.jsxs(x,{spacing:.5,children:[e.jsx(A,{alt:a[1],src:a[1],ratio:"1/1",sx:{borderRadius:1,width:80}}),e.jsx(A,{alt:a[2],src:a[2],ratio:"1/1",sx:{borderRadius:1,width:80}})]})]}),C=e.jsx(Y,{sx:{p:t=>t.spacing(2.5,2.5,2,2.5)},primary:`Posted date: ${Z(d)}`,secondary:e.jsx(ee,{component:H,href:w.dashboard.tour.details(l),color:"inherit",children:h}),primaryTypographyProps:{typography:"caption",color:"text.disabled"},secondaryTypographyProps:{mt:1,noWrap:!0,component:"span",color:"text.primary",typography:"subtitle1"}}),y=e.jsxs(x,{spacing:1.5,sx:{position:"relative",p:t=>t.spacing(0,2.5,2.5,2.5)},children:[e.jsx(W,{onClick:r.onOpen,sx:{position:"absolute",bottom:20,right:8},children:e.jsx(g,{icon:"eva:more-vertical-fill"})}),[{label:f,icon:e.jsx(g,{icon:"mingcute:location-fill",sx:{color:"error.main"}})},{label:I,icon:e.jsx(g,{icon:"solar:clock-circle-bold",sx:{color:"info.main"}})},{label:`${u.length} Booked`,icon:e.jsx(g,{icon:"solar:users-group-rounded-bold",sx:{color:"primary.main"}})}].map(t=>e.jsxs(x,{spacing:1,direction:"row",alignItems:"center",sx:{typography:"body2"},children:[t.icon,t.label]},t.label))]});return e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[j,C,y]}),e.jsxs($,{open:r.open,onClose:r.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(E,{onClick:()=>{r.onClose(),i()},children:[e.jsx(g,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(E,{onClick:()=>{r.onClose(),p()},children:[e.jsx(g,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(E,{onClick:()=>{r.onClose(),o()},sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})]})}function Oe({tours:s}){const i=K(),p=m.useCallback(l=>{i.push(w.dashboard.tour.details(l))},[i]),o=m.useCallback(l=>{i.push(w.dashboard.tour.edit(l))},[i]),r=m.useCallback(l=>{console.info("DELETE",l)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(k,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},children:s.map(l=>e.jsx(Re,{tour:l,onView:()=>p(l.id),onEdit:()=>o(l.id),onDelete:()=>r(l.id)},l.id))}),s.length>8&&e.jsx(ke,{count:8,sx:{mt:8,[`& .${Se.ul}`]:{justifyContent:"center"}}})]})}function Pe({sort:s,onSort:i,sortOptions:p}){const o=_();return e.jsxs(e.Fragment,{children:[e.jsxs(B,{disableRipple:!0,color:"inherit",onClick:o.onOpen,endIcon:e.jsx(g,{icon:o.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort By:",e.jsx(k,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),e.jsx($,{open:o.open,onClose:o.onClose,sx:{width:140},children:p.map(r=>e.jsx(E,{selected:r.value===s,onClick:()=>{o.onClose(),i(r.value)},children:r.label},r.value))})]})}function Fe({query:s,results:i,onSearch:p,hrefItem:o}){const r=K(),l=c=>{r.push(o(c))},h=c=>{if(s&&c.key==="Enter"){const a=i.filter(u=>u.name===s)[0];l(a.id)}};return e.jsx(J,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:i,onInputChange:(c,a)=>p(a),getOptionLabel:c=>c.name,noOptionsText:e.jsx(te,{query:s,sx:{bgcolor:"unset"}}),isOptionEqualToValue:(c,a)=>c.id===a.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${re.option}`]:{pl:.75}}}},renderInput:c=>e.jsx(Q,{...c,placeholder:"Search...",onKeyUp:h,InputProps:{...c.InputProps,startAdornment:e.jsx(ne,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(c,a,{inputValue:u})=>{const d=oe(a.name,u),n=ae(a.name,d);return m.createElement(k,{component:"li",...c,onClick:()=>l(a.id),key:a.id},e.jsx(L,{alt:a.name,src:a.images[0],variant:"rounded",sx:{width:48,height:48,flexShrink:0,mr:1.5,borderRadius:1}},a.id),e.jsx("div",{children:n.map((b,f)=>e.jsx(T,{component:"span",color:b.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:b.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:b.text},f))},u))}})}function Ee({open:s,onOpen:i,onClose:p,filters:o,onFilters:r,canReset:l,onResetFilters:h,destinationOptions:c,tourGuideOptions:a,serviceOptions:u,dateError:d}){const n=m.useCallback(t=>{const v=o.services.includes(t)?o.services.filter(S=>S!==t):[...o.services,t];r("services",v)},[o.services,r]),b=m.useCallback(t=>{r("startDate",t)},[r]),f=m.useCallback(t=>{r("endDate",t)},[r]),D=m.useCallback(t=>{r("destination",t)},[r]),I=m.useCallback(t=>{r("tourGuides",t)},[r]),R=e.jsxs(x,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(T,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(de,{title:"Reset",children:e.jsx(W,{onClick:h,children:e.jsx(z,{color:"error",variant:"dot",invisible:!l,children:e.jsx(g,{icon:"solar:restart-bold"})})})}),e.jsx(W,{onClick:p,children:e.jsx(g,{icon:"mingcute:close-line"})})]}),O=e.jsxs(x,{children:[e.jsx(T,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsxs(x,{spacing:2.5,children:[e.jsx(N,{label:"Start date",value:o.startDate,onChange:b}),e.jsx(N,{label:"End date",value:o.endDate,onChange:f,slotProps:{textField:{error:d,helperText:d&&"End date must be later than start date"}}})]})]}),j=e.jsxs(x,{children:[e.jsx(T,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Te,{placeholder:o.destination.length?"+ Destination":"Select Destination",fullWidth:!0,multiple:!0,value:o.destination,onChange:(t,v)=>D(v),options:c,getOptionLabel:t=>t})]}),C=e.jsxs(x,{children:[e.jsx(T,{variant:"subtitle2",sx:{mb:1.5},children:"Tour Guide"}),e.jsx(J,{multiple:!0,disableCloseOnSelect:!0,options:a,value:o.tourGuides,onChange:(t,v)=>I(v),getOptionLabel:t=>t.name,renderInput:t=>e.jsx(Q,{placeholder:"Select Tour Guides",...t}),renderOption:(t,v)=>m.createElement("li",{...t,key:v.id},e.jsx(L,{alt:v.avatarUrl,src:v.avatarUrl,sx:{width:24,height:24,flexShrink:0,mr:1}},v.id),v.name),renderTags:(t,v)=>t.map((S,X)=>m.createElement(P,{...v({index:X}),key:S.id,size:"small",variant:"soft",label:S.name,avatar:e.jsx(L,{alt:S.name,src:S.avatarUrl})}))})]}),y=e.jsxs(x,{children:[e.jsx(T,{variant:"subtitle2",sx:{mb:1},children:"Services"}),u.map(t=>e.jsx(De,{control:e.jsx(Ie,{checked:o.services.includes(t),onClick:()=>n(t)}),label:t},t))]});return e.jsxs(e.Fragment,{children:[e.jsx(B,{disableRipple:!0,color:"inherit",endIcon:e.jsx(z,{color:"error",variant:"dot",invisible:!l,children:e.jsx(g,{icon:"ic:round-filter-list"})}),onClick:i,children:"Filters"}),e.jsxs(ie,{anchor:"right",open:s,onClose:p,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:[R,e.jsx(le,{}),e.jsx(ce,{sx:{px:2.5,py:3},children:e.jsxs(x,{spacing:3,children:[O,j,C,y]})})]})]})}function Le({filters:s,onFilters:i,canReset:p,onResetFilters:o,results:r,...l}){const h=M(s.startDate,s.endDate),c=n=>{const b=s.services.filter(f=>f!==n);i("services",b)},a=()=>{i("startDate",null),i("endDate",null)},u=n=>{const b=s.tourGuides.filter(f=>f.name!==n.name);i("tourGuides",b)},d=n=>{const b=s.destination.filter(f=>f!==n);i("destination",b)};return e.jsxs(x,{spacing:1.5,...l,children:[e.jsxs(k,{sx:{typography:"body2"},children:[e.jsx("strong",{children:r}),e.jsx(k,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(x,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[s.startDate&&s.endDate&&e.jsx(F,{label:"Available:",children:e.jsx(P,{size:"small",label:h,onDelete:a})}),!!s.services.length&&e.jsx(F,{label:"Services:",children:s.services.map(n=>e.jsx(P,{label:n,size:"small",onDelete:()=>c(n)},n))}),!!s.tourGuides.length&&e.jsx(F,{label:"Tour guide:",children:s.tourGuides.map(n=>e.jsx(P,{size:"small",avatar:e.jsx(L,{alt:n.name,src:n.avatarUrl}),label:n.name,onDelete:()=>u(n)},n.id))}),!!s.destination.length&&e.jsx(F,{label:"Destination:",children:s.destination.map(n=>e.jsx(P,{label:n,size:"small",onDelete:()=>d(n)},n))}),p&&e.jsx(B,{color:"error",onClick:o,startIcon:e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function F({label:s,children:i,sx:p,...o}){return e.jsxs(x,{component:pe,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...p},...o,children:[e.jsx(k,{component:"span",sx:{typography:"subtitle2"},children:s}),e.jsx(x,{spacing:1,direction:"row",flexWrap:"wrap",children:i})]})}const V={destination:[],tourGuides:[],services:[],startDate:null,endDate:null};function Be(){const s=he(),i=xe(),[p,o]=m.useState("latest"),[r,l]=m.useState({query:"",results:[]}),[h,c]=m.useState(V),a=me(h.startDate,h.endDate),u=Ge({inputData:U,filters:h,sortBy:p,dateError:a}),d=!!h.destination.length||!!h.tourGuides.length||!!h.services.length||!!h.startDate&&!!h.endDate,n=!u.length&&d,b=m.useCallback((j,C)=>{c(y=>({...y,[j]:C}))},[]),f=m.useCallback(()=>{c(V)},[]),D=m.useCallback(j=>{o(j)},[]),I=m.useCallback(j=>{if(l(C=>({...C,query:j})),j){const C=U.filter(y=>y.name.toLowerCase().indexOf(r.query.toLowerCase())!==-1);l(y=>({...y,results:C}))}},[r.query]),R=e.jsxs(x,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(Fe,{query:r.query,results:r.results,onSearch:I,hrefItem:j=>w.dashboard.tour.details(j)}),e.jsxs(x,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Ee,{open:i.value,onOpen:i.onTrue,onClose:i.onFalse,filters:h,onFilters:b,canReset:d,onResetFilters:f,serviceOptions:ue.map(j=>j.label),tourGuideOptions:be,destinationOptions:je.map(j=>j.label),dateError:a}),e.jsx(Pe,{sort:p,onSort:D,sortOptions:ge})]})]}),O=e.jsx(Le,{filters:h,onResetFilters:f,canReset:d,onFilters:b,results:u.length});return e.jsxs(fe,{maxWidth:s.themeStretch?!1:"lg",children:[e.jsx(we,{heading:"List",links:[{name:"Dashboard",href:w.dashboard.root},{name:"Tour",href:w.dashboard.tour.root},{name:"List"}],action:e.jsx(B,{component:H,href:w.dashboard.tour.new,variant:"contained",startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(x,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[R,d&&O]}),n&&e.jsx(ye,{title:"No Data",filled:!0,sx:{py:10}}),e.jsx(Oe,{tours:u})]})}const Ge=({inputData:s,filters:i,sortBy:p,dateError:o})=>{const{services:r,destination:l,startDate:h,endDate:c,tourGuides:a}=i,u=a.map(d=>d.id);return p==="latest"&&(s=G(s,["createdAt"],["desc"])),p==="oldest"&&(s=G(s,["createdAt"],["asc"])),p==="popular"&&(s=G(s,["totalViews"],["desc"])),l.length&&(s=s.filter(d=>l.includes(d.destination))),u.length&&(s=s.filter(d=>d.tourGuides.some(n=>u.includes(n.id)))),r.length&&(s=s.filter(d=>d.services.some(n=>r.includes(n)))),o||h&&c&&(s=s.filter(d=>ve(h,d.available.startDate,d.available.endDate))),s};function gs(){return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:e.jsx("title",{children:" Dashboard: Tour List"})}),e.jsx(Be,{})]})}export{gs as default};
