import{e as H,r as h,p as V,j as e,B as I,I as v,ai as J,T as k,S as g,aj as G,a4 as Q,a3 as X,ak as Z,al as ee,l as $,am as z,an as se,ao as te,P as ne,ap as re,C as oe,R as ae}from"./index-BeqSvFdx.js";import{S as ie,o as E}from"./search-not-found-OxbVQxCK.js";import{u as le}from"./use-boolean-PB8MSLnA.js";import{f as S,i as ce,a as de}from"./format-time-CzRS7M6b.js";import{c as _,b as pe,T as me}from"./_calendar-CwMtJhpE.js";import{E as ue}from"./empty-content-BX8QoXsz.js";import{C as he}from"./custom-breadcrumbs-DN6Cp4VG.js";import{T as xe}from"./tour-item-C4aGZMXr.js";import{C as je}from"./custom-popover-DlSNauQC.js";import{u as ge}from"./use-popover-uhvNbQg9.js";import{B as A}from"./Button-e3NxAGlE.js";import{M as fe}from"./MenuItem-BOxjvZfz.js";import{m as be,p as ve}from"./styles-CfKqrYFI.js";import{A as W}from"./Autocomplete-Bfud0MfP.js";import{T as P}from"./TextField-CJUfAXj_.js";import{I as N}from"./InputAdornment-Bh02mCKt.js";import{A as D}from"./Avatar-BWEyCkgg.js";import{C as T}from"./Chip-DpLqfiAn.js";import{D as U}from"./book-form-CTUs6NQu.js";import{F as ye,C as Ce}from"./Checkbox-DZgqESH7.js";import{t as Y,T as Se}from"./helper-7KL5HGAd.js";import"./styles-CuajBVzG.js";import"./image-C28n8gFq.js";import"./index.esm-aOmBlU9I.js";import"./_baseIteratee-DSKU7bFi.js";import"./createSvgIcon-D6_KGotx.js";import"./format-number-EjGnuMZh.js";import"./Card-DQA9ub0E.js";import"./ListItemText-Bs_DMCuV.js";import"./Close-D9doIty9.js";import"./useFormControl-BCoRm7HX.js";import"./formControlState-Dq1zat_P.js";import"./useSlot-BfAPfM4K.js";import"./yup-CJFUrw1S.js";import"./DialogContent-BxVF-7Sz.js";import"./ListItem-Bdtyn1Ki.js";import"./SwitchBase-CcIjwpPz.js";function we({tours:s}){const t=H(),d=h.useCallback(r=>{t.push(V.packageDetails(r))},[t]);return e.jsx(e.Fragment,{children:e.jsx(I,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},sx:{mb:8},children:s==null?void 0:s.map(r=>e.jsx(xe,{tour:r,onView:()=>d(r.id)},r.id))})})}function ke({sort:s,onSort:t,sortOptions:d}){const r=ge();return e.jsxs(e.Fragment,{children:[e.jsxs(A,{disableRipple:!0,color:"inherit",onClick:r.onOpen,endIcon:e.jsx(v,{icon:r.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort By:",e.jsx(I,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),e.jsx(je,{open:r.open,onClose:r.onClose,sx:{width:140},children:d.map(o=>e.jsx(fe,{selected:o.value===s,onClick:()=>{r.onClose(),t(o.value)},children:o.label},o.value))})]})}function Te({query:s,results:t,onSearch:d,hrefItem:r}){const o=H(),u=i=>{o.push(r(i))},l=i=>{if(s&&i.key==="Enter"){const n=t.filter(m=>m.name===s)[0];u(n.id)}};return e.jsx(W,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:t,onInputChange:(i,n)=>d(n),getOptionLabel:i=>i.name,noOptionsText:e.jsx(ie,{query:s,sx:{bgcolor:"unset"}}),isOptionEqualToValue:(i,n)=>i.id===n.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${J.option}`]:{pl:.75}}}},renderInput:i=>e.jsx(P,{...i,placeholder:"Search...",onKeyUp:l,InputProps:{...i.InputProps,startAdornment:e.jsx(N,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(i,n,{inputValue:m})=>{const p=be(n.name,m),a=ve(n.name,p);return h.createElement(I,{component:"li",...i,onClick:()=>u(n.id),key:n.id},e.jsx(D,{alt:n.name,src:n.images[0],variant:"rounded",sx:{width:48,height:48,flexShrink:0,mr:1.5,borderRadius:1}},n.id),e.jsx("div",{children:a.map((x,b)=>e.jsx(k,{component:"span",color:x.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:x.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:x.text},b))},m))}})}function Ie({label:s,error:t,helperText:d,placeholder:r,...o}){const u=o==null?void 0:o.multiple;return e.jsx(W,{autoHighlight:!u,disableCloseOnSelect:u,renderOption:(l,i)=>{var m;const n=L(i);return n.label?h.createElement("li",{...l,key:n.label},e.jsx(v,{icon:`circle-flags:${(m=n.code)==null?void 0:m.toLowerCase()}`,sx:{mr:1}},n.label),n.label," (",n.code,") +",n.phone):null},renderInput:l=>{var m;const i=L(l.inputProps.value),n={...l,label:s,placeholder:r,error:!!t,helperText:d,inputProps:{...l.inputProps,autoComplete:"new-password"}};return u?e.jsx(P,{...n}):e.jsx(P,{...n,InputProps:{...l.InputProps,startAdornment:e.jsx(N,{position:"start",sx:{...!i.code&&{display:"none"}},children:e.jsx(v,{icon:`circle-flags:${(m=i.code)==null?void 0:m.toLowerCase()}`,sx:{mr:-.5,ml:.5}})})}})},renderTags:(l,i)=>l.map((n,m)=>{var a;const p=L(n);return h.createElement(T,{...i({index:m}),key:p.label,label:p.label,icon:e.jsx(v,{icon:`circle-flags:${(a=p.code)==null?void 0:a.toLowerCase()}`}),size:"small",variant:"soft"})}),...o})}function L(s){return{..._.filter(d=>d.label===s)[0]}}function Oe({open:s,onOpen:t,onClose:d,filters:r,onFilters:o,canReset:u,onResetFilters:l,destinationOptions:i,tourGuideOptions:n,serviceOptions:m,dateError:p}){const a=h.useCallback(c=>{const f=r.services.includes(c)?r.services.filter(w=>w!==c):[...r.services,c];o("services",f)},[r.services,o]),x=h.useCallback(c=>{o("startDate",c)},[o]),b=h.useCallback(c=>{o("endDate",c)},[o]),M=h.useCallback(c=>{o("destination",c)},[o]),R=h.useCallback(c=>{o("tourGuides",c)},[o]),F=e.jsxs(g,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(k,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(ee,{title:"Reset",children:e.jsx($,{onClick:l,children:e.jsx(G,{color:"error",variant:"dot",invisible:!u,children:e.jsx(v,{icon:"solar:restart-bold"})})})}),e.jsx($,{onClick:d,children:e.jsx(v,{icon:"mingcute:close-line"})})]}),B=e.jsxs(g,{children:[e.jsx(k,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsxs(g,{spacing:2.5,children:[e.jsx(U,{label:"Start date",value:r.startDate,onChange:x}),e.jsx(U,{label:"End date",value:r.endDate,onChange:b,slotProps:{textField:{error:p,helperText:p&&"End date must be later than start date"}}})]})]}),j=e.jsxs(g,{children:[e.jsx(k,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Ie,{placeholder:r.destination.length?"+ Destination":"Select Destination",fullWidth:!0,multiple:!0,value:r.destination,onChange:(c,f)=>M(f),options:i,getOptionLabel:c=>c})]}),y=e.jsxs(g,{children:[e.jsx(k,{variant:"subtitle2",sx:{mb:1.5},children:"Tour Guide"}),e.jsx(W,{multiple:!0,disableCloseOnSelect:!0,options:n,value:r.tourGuides,onChange:(c,f)=>R(f),getOptionLabel:c=>c.name,renderInput:c=>e.jsx(P,{placeholder:"Select Tour Guides",...c}),renderOption:(c,f)=>h.createElement("li",{...c,key:f.id},e.jsx(D,{alt:f.avatarUrl,src:f.avatarUrl,sx:{width:24,height:24,flexShrink:0,mr:1}},f.id),f.name),renderTags:(c,f)=>c.map((w,K)=>h.createElement(T,{...f({index:K}),key:w.id,size:"small",variant:"soft",label:w.name,avatar:e.jsx(D,{alt:w.name,src:w.avatarUrl})}))})]}),C=e.jsxs(g,{children:[e.jsx(k,{variant:"subtitle2",sx:{mb:1},children:"Services"}),m.map(c=>e.jsx(ye,{control:e.jsx(Ce,{checked:r.services.includes(c),onClick:()=>a(c)}),label:c},c))]});return e.jsxs(e.Fragment,{children:[e.jsx(A,{disableRipple:!0,color:"inherit",endIcon:e.jsx(G,{color:"error",variant:"dot",invisible:!u,children:e.jsx(v,{icon:"ic:round-filter-list"})}),onClick:t,children:"Filters"}),e.jsxs(Q,{anchor:"right",open:s,onClose:d,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:[F,e.jsx(X,{}),e.jsx(Z,{sx:{px:2.5,py:3},children:e.jsxs(g,{spacing:3,children:[B,j,y,C]})})]})]})}function Pe(s,t){const d=new Date().getFullYear(),r=s?z(s):null,o=t?z(t):null,u=d===r&&d===o,l=s&&t?se(new Date(s),new Date(t)):!1,i=s&&t?te(new Date(s),new Date(t)):!1;return u?i?l?S(t,"dd MMM yy"):`${S(s,"dd")} - ${S(t,"dd MMM yy")}`:`${S(s,"dd MMM")} - ${S(t,"dd MMM yy")}`:`${S(s,"dd MMM yy")} - ${S(t,"dd MMM yy")}`}function De({filters:s,onFilters:t,canReset:d,onResetFilters:r,results:o,...u}){const l=Pe(s.startDate,s.endDate),i=a=>{const x=s.services.filter(b=>b!==a);t("services",x)},n=()=>{t("startDate",null),t("endDate",null)},m=a=>{const x=s.tourGuides.filter(b=>b.name!==a.name);t("tourGuides",x)},p=a=>{const x=s.destination.filter(b=>b!==a);t("destination",x)};return e.jsxs(g,{spacing:1.5,...u,children:[e.jsxs(I,{sx:{typography:"body2"},children:[e.jsx("strong",{children:o}),e.jsx(I,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(g,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[s.startDate&&s.endDate&&e.jsx(O,{label:"Available:",children:e.jsx(T,{size:"small",label:l,onDelete:n})}),!!s.services.length&&e.jsx(O,{label:"Services:",children:s.services.map(a=>e.jsx(T,{label:a,size:"small",onDelete:()=>i(a)},a))}),!!s.tourGuides.length&&e.jsx(O,{label:"Tour guide:",children:s.tourGuides.map(a=>e.jsx(T,{size:"small",avatar:e.jsx(D,{alt:a.name,src:a.avatarUrl}),label:a.name,onDelete:()=>m(a)},a.id))}),!!s.destination.length&&e.jsx(O,{label:"Destination:",children:s.destination.map(a=>e.jsx(T,{label:a,size:"small",onDelete:()=>p(a)},a))}),d&&e.jsx(A,{color:"error",onClick:r,startIcon:e.jsx(v,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function O({label:s,children:t,sx:d,...r}){return e.jsxs(g,{component:ne,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...d},...r,children:[e.jsx(I,{component:"span",sx:{typography:"subtitle2"},children:s}),e.jsx(g,{spacing:1,direction:"row",flexWrap:"wrap",children:t})]})}const q={destination:[],tourGuides:[],services:[],startDate:null,endDate:null};function Me(){const s=re(),t=le(),[d,r]=h.useState("latest"),[o,u]=h.useState({query:"",results:[]}),[l,i]=h.useState(q),n=ce(l.startDate,l.endDate),m=Re({inputData:Y,filters:l,sortBy:d,dateError:n}),p=!!l.destination.length||!!l.tourGuides.length||!!l.services.length||!!l.startDate&&!!l.endDate,a=!m.length&&p,x=h.useCallback((j,y)=>{i(C=>({...C,[j]:y}))},[]),b=h.useCallback(()=>{i(q)},[]),M=h.useCallback(j=>{r(j)},[]),R=h.useCallback(j=>{if(u(y=>({...y,query:j})),j){const y=Y.filter(C=>C.name.toLowerCase().indexOf(o.query.toLowerCase())!==-1);u(C=>({...C,results:y}))}},[o.query]),F=e.jsxs(g,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(Te,{query:o.query,results:o.results,onSearch:R,hrefItem:j=>V.dashboard.tour.details(j)}),e.jsxs(g,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Oe,{open:t.value,onOpen:t.onTrue,onClose:t.onFalse,filters:l,onFilters:x,canReset:p,onResetFilters:b,serviceOptions:Se.map(j=>j.label),tourGuideOptions:pe,destinationOptions:_.map(j=>j.label),dateError:n}),e.jsx(ke,{sort:d,onSort:M,sortOptions:me})]})]}),B=e.jsx(De,{filters:l,onResetFilters:b,canReset:p,onFilters:x,results:m.length});return e.jsxs(oe,{maxWidth:s.themeStretch?!1:"lg",children:[e.jsx(he,{heading:"Packages List",sx:{mb:{xs:3,md:5}}}),e.jsxs(g,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[F,p&&B]}),a&&e.jsx(ue,{title:"No Data",filled:!0,sx:{py:10}}),e.jsx(we,{tours:m})]})}const Re=({inputData:s,filters:t,sortBy:d,dateError:r})=>{const{services:o,destination:u,startDate:l,endDate:i,tourGuides:n}=t,m=n==null?void 0:n.map(p=>p.id);return d==="latest"&&(s=E(s,["createdAt"],["desc"])),d==="oldest"&&(s=E(s,["createdAt"],["asc"])),d==="popular"&&(s=E(s,["totalViews"],["desc"])),u.length&&(s=s.filter(p=>u.includes(p.destination))),m.length&&(s=s.filter(p=>p.tourGuides.some(a=>m.includes(a.id)))),o.length&&(s=s.filter(p=>p.services.some(a=>o.includes(a)))),r||l&&i&&(s=s.filter(p=>de(l,p.available.startDate,p.available.endDate))),s};function js(){return e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:e.jsx("title",{children:"Airway Horizons: Package List"})}),e.jsx(Me,{})]})}export{js as default};
